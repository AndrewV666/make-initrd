#!/bin/sh -efu

. /scripts/functions

# wait 10 minutes for user input before report deadlock
# XXX: need other lock implementation for udev-io?
set_lock udev-tty 600

say() {
	[ "$#" -eq 0 ] || printf '\n' >/dev/systty
}

ask() {
	local ANS=
	read -r ANS </dev/systty
	printf '%s\n' "$ANS"
}

mod="${1-}"; shift ||:
[ "$#" -eq 0 ] || printf 'UDEV: %s' "$*" >/dev/systty

case "$mod" in
	ask|say) $mod "$@" ;;
	*) printf 'Usage: ${0##*/} <ask|say> [message]\n' >/dev/systty ;;
esac
