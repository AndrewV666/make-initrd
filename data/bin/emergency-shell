#!/bin/sh -efu

. /.initrd/initenv
. shell-error

msg=
[ -n "${RDSHELL-}" ] ||
	read msg < /.initrd/shell

# Disallow console access
[ "$PANIC" != 0 ] || reboot

for f in /lib/shell/*; do
	[ -x "$f" ] || break
	"$f"
done

[ -z "$msg" ] || message "$msg"
PS1='(initramfs)$ ' exec /bin/sh -i +m
