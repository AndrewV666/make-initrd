#!/bin/sh -efu

. /scripts/locks

tty=/dev/tty
say() {
	printf '\n' >$tty
}

ask() {
	local ANS=
	read -r ANS <$tty
	printf '%s\n' "$ANS"
}

# wait 10 minutes for user input before report deadlock
# XXX: need other lock implementation for udev-io?
set_lock tty 600

mod="${1-}"
case "$mod" in
	ask|say)
		shift
		[ "$#" -eq 0 ] || printf 'UDEV: %s' "$*" >$tty
		$mod
		;;
	*)
		printf "Usage: ${0##*/} <ask|say> [message]\n" >$tty
		;;
esac
