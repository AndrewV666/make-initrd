#!/bin/sh -efu

. shell-error
. sh-functions

export LIBMOUNT_FSTAB="${FSTAB:-/etc/fstab}"
export LIBMOUNT_MTAB="${PROC_MOUNTS:-$PROCFS_PATH/mounts}"

mkdir -p -- "$rootdir"/etc

for dir in ${MOUNTPOINTS-}; do
	out="$(findmnt -n -o UUID,TARGET,FSTYPE,OPTIONS --target "$dir")" ||
		continue
	printf 'UUID=%s 0 0\n' "$out"
done >"$rootdir"/etc/fstab

sort -uo "$rootdir"/etc/fstab "$rootdir"/etc/fstab
