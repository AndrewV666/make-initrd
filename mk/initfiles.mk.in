PUT_DIRS  ?=
PUT_FILES ?=
PUT_PROGS ?=

# UDEV utilities
PUT_FILES += \
	/sbin/udevd \
	/sbin/udevadm \
	/lib/udev/ata_id \
	/lib/udev/cdrom_id \
	/lib/udev/scsi_id

UDEV_FILES_OLD = \
	/lib/udev/edd_id \
	/lib/udev/vol_id \
	/lib/udev/path_id \
	/lib/udev/usb_id \
	/lib/udev/firmware

PUT_FILES += $(wildcard $(UDEV_FILES_OLD))

# System utilities
REQUIRED_UTILITIES = \
	blkid cat chmod chroot cp depmod dmesg findmnt grep kill killall5 ln logger ls \
	lsmod mkdir mknod mktemp modprobe mount mountpoint mv readlink rm rmdir runas \
	setsid sh sleep start-stop-daemon switch_root touch umount which

define append_PUT_FILES =
$(eval fullname = $(shell "$(TOOLSDIR)/which.sh" "$(1)"))
PUT_FILES += $(if $(fullname),\
		$(fullname),\
		$(error Required utility not found: '$(1)'))
endef

$(foreach name,$(REQUIRED_UTILITIES), $(eval $(call append_PUT_FILES,$(name))))

ifneq ($(realpath /usr/share/terminfo/l),)
PUT_FILES += /usr/share/terminfo/l
endif

ifneq ($(realpath /var/resolv),)
PUT_FILES += /var/resolv
endif

# Add libshell
PUT_FILES += $(wildcard /bin/shell-*)

# initrd specific utilities
PUT_DIRS += $(DATADIR)
ifneq ($(LOCALBUILDDIR),)
PUT_DIRS += $(LOCALBUILDDIR)/lib/initrd
endif
PUT_DIRS += /lib/initrd
